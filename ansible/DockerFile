FROM harness/delegate:latest  # Use Harness official delegate image

# Install required dependencies
RUN apt-get update && apt-get install -y \
    ansible \
    sshpass \
    python3-pip && \
    pip3 install --upgrade pip

# Verify Ansible installation
RUN ansible --version

# Set working directory
WORKDIR /opt/harness-delegate

# Run delegate
ENTRYPOINT ["/entrypoint.sh"]
